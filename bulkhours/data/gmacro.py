from io import StringIO
import pandas as pd

from .data_parser import DataParser
from .world import get_mapgeneric


@DataParser.register_dataset(
    label="gmacro.fr_qgdp",
    summary="Evolution du PIB et de ses composantes par rapport au trimestre precedent en volume en %",
    category="Economics",
    source="""- Note : données revisitées ; les volumes sont mesures aux prix de l'année précédente changés et corrigés des variations saisonnieres et des effets des jours ouvrables.
- Lecture: au 4e trimestre 2022. le produit interieur brut (PIB) en volume augmente de 0.1 % par rapport au trimestre precedent.""",
    enrich_data="https://github.com/gtherin/bulkhours/blob/main/bulkhours/data/gmacro.py",
    ref_source="https://www.insee.fr/fr/statistiques/2830547#tableau-figure1",
)
def get_fr_qgdp(self):
    data = StringIO(
        """quarter;gdp;Importations;consommation_menages;consommation_APU1;capital_fixe;capital_fixe_non_financieres;menages;APU1;Exportations;demande_interieure;Variations de stocks;Commerce exterieur
2022-T4;0,1;-1,9;-0,9;0,2;0,8;1,2;-0,2;0,3;-0,3;-0,2;-0,2;0,5
2022-T3;0,2;3,9;0,5;0,2;2,3;3,8;-0,7;1,0;0,8;0,9;0,3;-1,0
2022-T2;0,5;1,5;0,5;0,0;0,3;0,5;-0,1;-0,2;1,0;0,3;0,3;-0,2
2022-T1;-0,2;1,3;-1,0;0,2;0,4;0,2;0,0;1,1;1,7;-0,4;0,1;0,1
2021-T4;0,6;5,0;0,6;0,6;-0,3;-0,2;-0,7;-0,5;2,9;0,4;0,8;-0,6
2021-T3;3,3;0,6;5,4;3,1;0,5;0,9;1,2;-1,6;2,1;3,7;-0,8;0,4
2021-T2;1,1;1,9;1,2;0,6;2,1;1,8;4,0;0,5;2,6;1,2;-0,3;0,1
2021-T1;0,1;1,4;0,5;-0,6;0,7;0,6;0,4;-1,5;-0,4;0,3;0,3;-0,6
2020-T4;-0,9;0,8;-5,5;-0,1;2,5;2,0;6,1;0,4;3,7;-2,4;0,7;0,8
2020-T3;18,4;17,7;18,2;17,6;24,2;24,8;28,8;17,4;22,4;19,7;-1,9;0,6
2020-T2;-13,5;-19,2;-11,6;-11,8;-14,3;-13,5;-16,3;-12,5;-25,3;-12,3;0,4;-1,6
2020-T1;-5,6;-5,5;-5,2;-3,3;-9,6;-8,8;-14,2;-5,1;-6,8;-5,8;0,6;-0,3
2019-T4;-0,3;-1,0;0,2;0,1;0,3;0,4;0,4;0,3;-1,1;0,2;-0,5;0,0
2019-T3;0,0;-0,4;0,2;0,4;0,8;0,6;0,9;1,2;-1,1;0,4;-0,1;-0,2
2019-T2;0,7;0,0;0,6;0,3;1,7;1,2;1,9;2,6;0,3;0,8;-0,2;0,1
2019-T1;0,7;2,2;0,8;0,1;1,0;0,4;0,4;3,0;0,3;0,7;0,6;-0,6
2018-T4;0,6;1,3;0,2;0,5;0,8;0,3;0,0;3,0;2,2;0,4;-0,1;0,3
2018-T3;0,4;-1,1;0,4;-0,1;0,7;0,6;0,4;1,2;0,2;0,4;-0,4;0,4
2018-T2;0,4;1,0;-0,1;0,3;1,3;1,7;0,7;1,5;0,9;0,3;0,2;-0,1
2018-T1;0,1;0,6;0,4;0,0;0,1;0,1;0,1;0,4;-0,2;0,2;0,1;-0,2
2017-T4;0,6;1,3;0,0;0,1;0,8;1,4;0,4;0,0;2,5;0,2;0,0;0,4
2017-T3;0,9;1,9;0,7;0,5;1,3;1,9;0,6;0,4;1,5;0,8;0,2;-0,1
2017-T2;0,8;-0,1;0,3;0,5;1,1;1,2;1,6;0,1;2,7;0,6;-0,6;0,9
2017-T1;0,8;2,2;0,4;0,1;2,4;3,1;2,1;-0,4;-0,3;0,8;0,8;-0,8
2016-T4;0,6;0,8;0,9;0,4;0,9;0,5;1,5;0,5;1,4;0,8;-0,4;0,2
2016-T3;0,3;2,0;0,0;0,5;0,4;0,0;1,1;-0,5;0,5;0,2;0,6;-0,5
2016-T2;-0,3;-1,7;0,0;0,2;-0,2;-0,9;0,7;0,1;0,2;0,0;-0,9;0,6
2016-T1;0,6;0,6;1,3;0,4;1,1;1,8;0,4;-0,7;-0,2;1,0;-0,1;-0,2
2015-T4;0,2;1,9;-0,1;0,4;1,1;1,1;0,8;1,1;0,9;0,3;0,3;-0,3
2015-T3;0,2;1,8;0,2;0,2;1,2;1,0;0,7;2,8;0,0;0,4;0,4;-0,6
2015-T2;0,1;0,1;0,3;0,2;-0,8;0,4;-0,3;-5,5;1,6;0,0;-0,4;0,5
2015-T1;0,5;2,1;0,5;0,2;1,0;1,6;0,0;0,2;0,9;0,6;0,4;-0,4
2014-T4;0,0;1,1;0,3;0,3;-0,7;-0,6;-0,8;-1,8;1,7;0,1;-0,3;0,2
2014-T3;0,6;1,8;0,3;0,4;0,5;1,5;-1,3;-1,4;1,6;0,4;0,3;-0,1
2014-T2;0,1;1,1;0,6;0,3;-0,3;0,3;-2,1;-1,5;0,0;0,3;0,1;-0,3
2014-T1;0,0;1,0;-0,5;0,3;-0,5;-0,5;-0,8;-1,8;0,7;-0,3;0,4;-0,1
2013-T4;0,6;1,2;0,6;0,3;0,8;1,3;0,4;-1,0;1,2;0,6;0,1;0,0
2013-T3;-0,1;1,0;0,0;0,3;0,1;0,6;-0,1;-1,1;-0,3;0,1;0,2;-0,4
2013-T2;0,7;2,2;0,4;0,5;0,2;0,7;0,0;0,0;2,3;0,4;0,3;0,0
2013-T1;0,1;-0,2;0,0;0,4;-0,6;-0,5;0,3;-0,1;0,0;0,0;0,1;0,1
2012-T4;-0,1;0,0;0,2;0,3;-0,4;-0,2;-0,2;-0,1;0,1;0,1;-0,3;0,0
2012-T3;0,2;0,4;0,1;0,3;0,3;0,6;-0,3;0,7;0,0;0,2;0,2;-0,1
2012-T2;-0,2;0,3;-0,2;0,5;-0,8;-0,9;-2,0;0,6;0,8;-0,2;-0,1;0,1
2012-T1;0,0;0,9;0,2;0,5;-0,5;-1,3;-0,3;0,4;0,5;0,1;0,0;-0,1
2011-T4;0,2;-0,8;-0,4;0,3;1,2;1,5;0,3;0,9;1,8;0,1;-0,7;0,7
2011-T3;0,5;0,1;0,2;0,6;0,6;0,8;-0,5;0,2;0,6;0,4;0,0;0,1
2011-T2;-0,1;-1,2;-1,2;0,1;0,2;0,3;-0,3;-0,6;1,0;-0,6;-0,2;0,6
2011-T1;1,1;3,9;0,5;0,3;0,2;1,0;-0,1;-2,8;2,4;0,4;1,2;-0,5
2010-T4;0,7;0,9;0,8;0,1;0,5;1,2;0,5;-1,7;1,5;0,6;0,0;0,1
2010-T3;0,6;2,8;0,6;0,4;1,3;1,6;1,7;-0,1;1,0;0,7;0,4;-0,5
2010-T2;0,5;4,2;0,3;0,2;0,8;1,4;1,3;-1,0;3,3;0,4;0,3;-0,2
2010-T1;0,3;0,7;0,2;0,1;1,0;1,9;0,9;-0,7;3,7;0,4;-0,8;0,8
2009-T4;0,7;3,7;0,7;0,5;0,5;1,0;-0,1;0,7;0,1;0,7;1,0;-1,0
2009-T3;0,2;1,0;0,0;0,5;-0,6;-0,5;-1,2;0,3;1,8;0,0;0,0;0,2
2009-T2;0,0;-1,9;0,7;0,7;-2,5;-3,5;-2,5;0,9;0,0;0,0;-0,5;0,5
2009-T1;-1,7;-7,1;-0,1;0,7;-4,1;-6,0;-5,3;2,9;-7,5;-0,8;-0,9;0,0
2008-T4;-1,5;-2,7;-0,4;0,8;-3,2;-4,2;-4,5;1,6;-4,7;-0,8;-0,2;-0,5
2008-T3;-0,2;-0,4;0,1;0,5;-0,8;-0,2;-2,9;-0,1;-0,9;0,0;0,0;-0,2
2008-T2;-0,5;-0,8;0,0;0,1;-1,1;-0,9;-1,5;-1,9;-1,5;-0,3;-0,1;-0,2
2008-T1;0,5;1,1;-0,4;0,1;1,6;2,7;-0,3;0,3;2,3;0,2;0,0;0,3
2007-T4;0,2;0,6;0,3;0,2;0,5;1,2;-0,2;-1,3;0,4;0,3;-0,1;-0,1
2007-T3;0,5;0,7;0,9;0,4;1,2;2,4;-0,2;-0,3;0,2;0,9;-0,2;-0,2
2007-T2;0,7;2,8;1,0;0,5;1,2;2,0;0,7;-0,1;1,6;0,9;0,1;-0,4
2007-T1;0,7;1,0;0,6;0,6;1,8;2,7;0,9;1,8;0,3;0,9;0,0;-0,2
2006-T4;0,7;2,6;0,5;0,5;1,5;2,3;0,7;1,0;1,9;0,8;0,1;-0,2
2006-T3;0,1;-0,6;0,2;0,1;0,7;0,9;0,7;-0,1;-1,5;0,3;0,0;-0,2
2006-T2;1,0;1,6;0,6;0,4;1,9;2,5;1,6;0,2;1,5;0,8;0,2;0,0
2006-T1;0,8;0,5;0,8;0,6;0,6;0,3;1,4;-0,9;2,2;0,7;-0,4;0,5
2005-T4;0,7;3,3;0,6;0,1;0,6;0,7;1,3;-1,3;2,3;0,5;0,5;-0,3
2005-T3;0,6;2,5;0,5;0,3;1,0;1,0;1,2;0,7;2,2;0,6;0,0;-0,1
2005-T2;0,3;0,9;0,2;0,4;0,5;0,2;1,7;0,5;1,4;0,3;-0,2;0,1
2005-T1;0,2;0,4;0,6;0,3;0,6;0,8;1,0;0,2;-0,7;0,5;0,0;-0,3
2004-T4;0,8;2,5;1,5;0,3;1,4;1,8;0,8;1,9;2,0;1,1;-0,3;-0,1
2004-T3;0,3;1,8;0,0;0,3;0,3;0,3;0,6;0,3;0,4;0,1;0,5;-0,4
2004-T2;0,6;2,0;0,4;0,5;0,5;0,2;1,1;0,5;1,7;0,5;0,2;0,0
2004-T1;1,0;0,7;0,6;0,6;1,1;1,0;1,3;0,8;0,4;0,7;0,4;-0,1
2003-T4;0,7;1,7;0,3;0,8;0,2;-0,4;0,9;0,7;2,6;0,4;0,0;0,3
2003-T3;0,7;0,9;0,6;0,4;1,7;2,1;1,0;0,9;1,1;0,7;-0,1;0,1
2003-T2;-0,2;-0,7;0,1;0,6;0,0;-0,9;0,5;1,4;-0,8;0,2;-0,3;-0,1
2003-T1;0,1;0,1;0,4;0,0;0,1;-0,5;0,4;1,1;-2,2;0,2;0,5;-0,6
2002-T4;0,2;0,0;0,6;0,7;1,1;0,9;0,7;1,5;0,1;0,7;-0,5;0,0
2002-T3;0,2;0,8;0,6;0,6;0,4;0,3;0,8;0,3;0,4;0,5;-0,2;-0,1
2002-T2;0,4;0,7;0,5;0,9;-0,6;-1,7;0,8;0,7;2,5;0,3;-0,4;0,5
2002-T1;0,6;2,5;0,4;0,2;-0,6;-1,1;0,8;-0,6;1,5;0,2;0,6;-0,2
2001-T4;-0,1;-0,6;0,4;0,3;-0,2;-0,8;0,8;0,6;-1,3;0,3;-0,1;-0,2
2001-T3;0,3;-1,6;0,2;0,3;0,1;0,5;0,4;-0,7;0,1;0,3;-0,5;0,5
2001-T2;0,1;-0,7;0,7;0,2;-0,3;-0,1;-0,1;-0,9;-2,3;0,4;0,2;-0,5
2001-T1;0,5;-1,4;1,0;0,2;0,6;1,2;0,3;-0,3;0,2;0,7;-0,7;0,4
2000-T4;0,8;3,2;0,3;0,2;0,6;1,0;0,0;0,2;4,0;0,3;0,2;0,3
2000-T3;0,7;3,8;0,6;0,3;1,9;3,2;0,1;0,8;2,1;0,8;0,3;-0,4
2000-T2;1,0;4,4;0,7;0,4;1,4;1,3;0,4;2,8;3,5;0,8;0,4;-0,2
2000-T1;1,0;4,3;0,7;0,6;1,7;1,2;1,5;3,2;4,0;0,9;0,2;0,0
1999-T4;1,4;4,4;1,0;0,6;1,9;1,5;1,2;3,3;2,4;1,1;0,8;-0,4
1999-T3;1,1;2,5;2,5;0,6;1,9;2,0;1,4;1,9;3,8;1,9;-1,1;0,4
1999-T2;0,3;1,8;0,4;0,3;1,7;2,1;1,3;1,0;2,1;0,7;-0,5;0,1
1999-T1;1,1;0,9;0,1;0,6;2,3;2,5;2,9;0,8;-0,3;0,7;0,7;-0,3
1998-T4;0,7;0,7;0,6;0,5;1,4;1,3;1,8;0,8;-0,3;0,7;0,2;-0,2
1998-T3;0,7;1,5;1,4;0,0;1,9;1,9;1,8;1,4;1,5;1,1;-0,4;0,0
1998-T2;0,8;2,0;1,0;-0,3;2,0;2,6;1,4;0,8;1,6;0,9;0,0;-0,1
1998-T1;0,9;4,0;0,9;-0,5;1,6;2,2;0,7;0,5;1,7;0,7;0,7;-0,5
1997-T4;1,0;2,8;1,2;-0,2;1,5;2,1;1,0;-0,1;3,0;0,9;-0,1;0,1
1997-T3;1,0;4,3;1,0;0,1;0,6;0,8;1,2;-1,4;3,1;0,6;0,5;-0,2
1997-T2;1,0;2,7;0,2;0,1;1,5;2,4;1,4;-1,3;4,5;0,4;0,1;0,5
1997-T1;0,3;1,8;-0,1;0,1;-1,0;-1,3;0,5;-2,4;3,4;-0,2;0,2;0,4
1996-T4;0,3;1,4;-1,1;0,6;-0,2;0,0;0,7;-1,8;3,1;-0,5;0,3;0,4
1996-T3;0,5;-0,2;1,4;0,4;0,5;0,6;1,1;-0,7;2,0;1,0;-0,9;0,5
1996-T2;0,1;0,4;-0,4;0,7;-0,3;-1,3;0,4;1,0;-0,2;-0,1;0,4;-0,1
1996-T1;0,7;0,9;1,7;0,8;0,8;1,0;0,3;0,2;1,8;1,2;-0,8;0,2
1995-T4;0,0;-0,4;-0,1;0,5;0,1;-0,1;-0,7;1,1;0,7;0,1;-0,4;0,2
1995-T3;0,2;0,6;-0,6;0,4;0,1;0,5;-0,4;-1,0;-0,9;-0,2;0,7;-0,3
1995-T2;0,6;3,3;1,6;0,1;-0,5;-0,7;-0,7;-0,1;2,6;0,8;-0,1;-0,1
1995-T1;0,3;0,0;0,1;-0,3;0,8;1,3;0,5;-1,6;1,5;0,1;-0,2;0,3
1994-T4;0,9;3,8;0,5;0,0;0,4;0,4;1,3;-1,0;4,6;0,4;0,3;0,2
1994-T3;0,9;3,2;0,4;0,0;0,8;1,7;1,5;-1,8;3,1;0,4;0,4;0,0
1994-T2;1,0;3,2;0,8;0,0;1,1;1,5;1,6;0,0;3,6;0,7;0,2;0,1
1994-T1;0,7;2,3;0,0;-0,2;1,6;1,4;1,9;2,7;0,0;0,3;0,8;-0,5
1993-T4;0,2;2,6;0,4;0,2;-0,3;-0,2;0,6;-0,2;3,4;0,2;-0,2;0,2
1993-T3;0,2;0,8;0,1;0,2;-1,3;-1,2;-0,7;-1,1;1,7;-0,2;0,2;0,2
1993-T2;0,0;-3,4;0,7;1,1;-1,8;-1,6;-1,5;-2,1;-2,8;0,2;-0,4;0,1
1993-T1;-0,7;0,2;-1,4;1,1;-1,7;-2,7;-1,3;-0,7;1,8;-0,9;-0,1;0,3
1992-T4;-0,2;-1,8;0,6;1,0;-1,4;-2,2;-1,7;-0,4;-1,3;0,2;-0,5;0,1
1992-T3;-0,1;-1,7;0,5;1,2;-1,1;-1,7;-0,7;-0,1;-0,8;0,3;-0,5;0,2
1992-T2;0,1;-0,8;0,2;0,7;-1,2;-0,9;-2,0;-0,7;0,7;0,0;-0,3;0,3
1992-T1;0,8;3,8;0,1;0,6;0,6;1,0;0,8;1,2;2,2;0,4;0,8;-0,4
1991-T4;0,7;-0,6;0,3;0,9;-0,7;-0,8;-3,4;0,9;2,2;0,2;-0,2;0,6
1991-T3;0,2;0,0;-0,1;0,5;-0,1;-0,5;-1,0;1,2;2,6;0,1;-0,4;0,6
1991-T2;0,4;0,0;0,1;1,3;0,4;0,6;-1,5;1,7;2,8;0,5;-0,6;0,6
1991-T1;0,1;2,9;-0,1;0,9;-0,9;-0,6;-2,7;0,1;0,7;-0,1;0,7;-0,5
1990-T4;0,0;-0,2;0,6;0,6;-0,1;0,0;-0,6;0,0;1,8;0,4;-0,9;0,4
1990-T3;0,5;-0,3;0,0;1,2;0,6;1,4;-2,0;1,0;0,6;0,4;-0,1;0,2
1990-T2;0,5;1,6;0,4;0,3;0,4;0,6;-1,2;1,5;-1,2;0,4;0,7;-0,6
1990-T1;0,4;0,1;1,1;1,2;1,4;1,9;-0,7;2,5;1,3;1,2;-1,0;0,2
1989-T4;1,3;4,2;0,4;0,8;2,0;2,7;0,2;2,1;3,3;0,9;0,7;-0,2
1989-T3;1,1;0,1;1,1;0,6;1,2;1,5;0,5;1,3;-0,4;1,0;0,1;-0,1
1989-T2;1,2;2,6;0,4;0,1;1,6;1,4;3,8;-0,4;2,6;0,6;0,6;0,0
1989-T1;1,2;1,9;1,0;0,6;2,4;3,5;0,7;1,7;4,3;1,2;-0,5;0,5
1988-T4;0,9;1,6;0,8;-0,2;1,6;1,1;3,6;1,0;1,4;0,8;0,1;-0,1
1988-T3;1,3;4,3;1,3;0,6;2,0;2,4;2,2;1,0;3,3;1,3;0,2;-0,2
1988-T2;0,8;0,5;0,5;0,6;1,8;2,0;0,7;2,8;1,5;0,8;-0,2;0,2
1988-T1;1,2;1,8;0,0;1,1;2,5;2,3;2,2;2,9;1,2;0,8;0,6;-0,1
1987-T4;1,4;2,3;1,8;1,3;1,9;2,5;-0,1;2,8;1,9;1,7;-0,2;-0,1
1987-T3;0,7;1,9;0,1;0,8;2,1;2,2;1,4;2,9;2,9;0,7;-0,2;0,2
1987-T2;1,5;2,4;1,3;0,7;2,3;3,0;0,0;3,4;2,6;1,4;0,0;0,0
1987-T1;0,1;4,1;1,0;0,4;0,3;0,4;2,2;-2,3;-0,9;0,7;0,5;-1,0
1986-T4;0,1;-2,5;0,2;0,8;0,8;0,9;0,7;0,9;-1,2;0,5;-0,7;0,4
1986-T3;0,5;3,2;0,5;0,7;0,9;1,3;-0,2;1,2;2,1;0,7;0,1;-0,3
1986-T2;1,1;1,7;1,6;0,7;1,5;1,4;-0,1;3,7;-1,9;1,4;0,6;-0,8
1986-T1;0,4;1,7;0,9;0,5;0,6;1,9;0,2;-2,5;-0,9;0,7;0,2;-0,6
1985-T4;0,4;1,8;1,1;0,8;0,6;0,5;0,7;0,5;1,2;0,9;-0,4;-0,1
1985-T3;0,5;1,9;0,6;0,4;1,4;1,4;1,3;1,5;-1,8;0,7;0,7;-0,9
1985-T2;0,9;0,6;0,5;0,8;1,7;2,7;-1,9;4,0;2,3;0,8;-0,3;0,4
1985-T1;0,3;1,6;1,4;0,8;-0,1;0,0;-0,9;0,6;-0,4;0,9;-0,1;-0,5
1984-T4;-0,1;1,9;-0,7;0,6;0,8;1,7;-1,5;1,5;-0,1;-0,1;0,5;-0,5
1984-T3;0,7;-1,3;0,2;1,2;-0,2;0,6;-3,1;1,5;1,3;0,3;-0,3;0,6
1984-T2;0,4;2,4;0,4;0,7;-0,5;-1,0;0,3;-1,1;3,8;0,2;-0,1;0,3
1984-T1;0,4;1,3;0,4;0,0;0,4;0,8;-1,2;1,0;-0,3;0,3;0,5;-0,4
1983-T4;0,6;0,6;0,5;0,6;-0,5;-0,2;-1,4;-0,4;1,8;0,3;0,0;0,3
1983-T3;0,1;2,6;-0,4;0,7;-0,4;-0,3;-0,5;-1,0;4,0;-0,2;0,0;0,3
1983-T2;0,0;-3,2;-0,2;0,0;-1,1;-1,1;-0,7;-1,9;2,3;-0,4;-0,9;1,2
1983-T1;0,4;-1,3;-0,2;0,5;-0,5;-1,2;0,5;0,0;-1,1;-0,1;0,5;0,1
1982-T4;0,6;-0,2;1,2;0,7;-1,0;0,0;-2,8;-1,2;3,6;0,6;-0,8;0,8
1982-T3;0,0;-1,2;0,0;1,7;-1,5;-2,0;-0,7;-1,5;-0,3;0,0;-0,3;0,2
1982-T2;0,7;2,0;1,0;0,7;0,4;1,4;-2,3;1,8;-2,6;0,8;0,9;-1,0
1982-T1;0,8;0,1;0,8;1,5;-0,6;0,4;-2,8;-0,1;-0,7;0,6;0,4;-0,2
1981-T4;0,6;1,3;1,4;0,7;0,6;1,1;-1,2;2,2;-2,5;1,0;0,4;-0,8
1981-T3;0,7;3,0;0,1;0,9;-0,1;-0,3;-0,5;0,9;3,2;0,2;0,4;0,0
1981-T2;0,7;-0,5;1,5;0,8;0,2;-0,2;0,1;1,1;3,0;1,0;-1,1;0,8
1981-T1;0,3;-1,8;-0,1;0,7;-0,5;-0,8;-1,4;1,2;1,1;0,0;-0,3;0,7
1980-T4;-0,2;-1,7;0,7;0,5;-0,7;-1,1;-0,5;-0,4;1,1;0,3;-1,1;0,6
1980-T3;0,2;0,5;0,7;0,8;-0,1;0,8;-1,6;0,0;-1,0;0,5;-0,1;-0,3
1980-T2;-0,7;-0,5;-1,2;0,8;-0,2;0,7;-1,4;-0,4;-0,9;-0,5;-0,1;-0,1
1980-T1;1,0;3,6;0,8;nd;0,8;1,2;1,3;-0,8;1,5;0,8;0,6;-0,4
1979-T4;0,3;0,2;0,5;nd;1,7;2,5;1,2;0,3;0,5;0,8;-0,6;0,1
1979-T3;1,3;3,9;0,2;nd;2,4;3,7;0,8;1,4;3,8;0,9;0,4;0,0
1979-T2;0,4;0,8;0,7;nd;0,8;1,2;-0,4;1,8;0,6;0,7;-0,2;0,0
1979-T1;1,1;3,3;1,0;nd;-0,7;-1,3;0,5;-1,9;1,9;0,5;0,8;-0,2
1978-T4;1,1;2,7;1,4;nd;1,3;1,3;1,0;1,7;1,6;1,3;0,0;-0,2
1978-T3;0,6;0,4;0,3;nd;0,3;-0,5;1,9;-0,2;1,3;0,5;-0,1;0,2
1978-T2;1,1;1,6;1,6;nd;1,4;1,7;1,1;1,2;1,5;1,5;-0,4;0,0
1978-T1;1,4;2,3;1,2;nd;1,5;1,1;3,9;-1,0;1,3;1,4;0,1;-0,2
1977-T4;0,8;0,3;0,4;nd;-0,4;-1,1;0,9;-0,7;1,7;0,4;0,1;0,3
1977-T3;0,8;-0,4;1,3;nd;0,3;0,1;0,6;0,1;2,3;1,0;-0,7;0,5
1977-T2;0,4;-0,2;0,2;nd;-0,5;0,8;0,5;-6,1;1,8;0,2;-0,2;0,4
1977-T1;1,1;-1,2;0,0;nd;0,9;2,4;-1,9;0,6;0,8;0,3;0,4;0,4
1976-T4;0,7;0,3;1,0;nd;-0,6;-1,1;1,3;-2,6;3,5;0,4;-0,4;0,6
1976-T3;1,2;3,9;1,4;nd;-1,7;-1,3;-2,3;-2,2;1,0;0,5;1,3;-0,6
1976-T2;1,4;4,7;0,9;nd;0,4;-0,7;3,2;-0,8;3,5;0,7;0,9;-0,3
1976-T1;1,0;7,4;1,4;nd;2,3;4,4;0,0;1,2;3,2;1,5;0,2;-0,7
1975-T4;2,1;5,0;1,9;nd;2,0;3,9;-0,6;1,8;1,7;1,9;0,9;-0,7
1975-T3;0,0;1,4;1,6;nd;-1,5;-2,7;-1,6;2,1;-0,1;0,7;-0,5;-0,3
1975-T2;0,0;0,2;0,8;nd;-0,6;-0,5;-2,6;2,6;-0,7;0,6;-0,5;-0,2
1975-T1;-0,8;-6,3;0,2;nd;-2,1;-2,9;-3,0;1,9;-4,1;-0,2;-1,2;0,7
1974-T4;-1,8;-6,1;-0,4;nd;-2,6;-4,5;-1,8;1,1;-0,6;-0,6;-2,2;0,9
1974-T3;1,1;-0,5;0,1;nd;-0,9;-2,1;-0,5;1,8;2,7;0,0;0,5;0,6
1974-T2;0,7;0,7;0,6;nd;0,8;1,4;0,1;-0,1;0,8;0,8;-0,2;0,0
1974-T1;1,6;2,9;0,2;nd;0,4;-0,9;2,5;0,6;4,2;0,4;0,9;0,3
1973-T4;1,2;2,0;2,4;nd;1,2;0,8;2,4;0,2;4,3;1,7;-1,0;0,4
1973-T3;1,5;4,1;0,5;nd;2,3;2,8;2,3;0,3;2,5;1,0;0,8;-0,3
1973-T2;1,4;1,5;0,7;nd;1,8;1,7;2,9;-0,3;2,6;1,1;0,2;0,2
1973-T1;1,8;5,3;2,4;nd;1,4;1,0;1,9;1,1;2,9;1,9;0,2;-0,4
1972-T4;1,6;5,7;0,8;nd;2,0;1,7;2,1;1,7;5,1;1,2;0,4;-0,1
1972-T3;1,4;1,4;2,3;nd;1,5;1,3;2,1;0,6;0,0;1,8;-0,2;-0,2
1972-T2;0,7;1,2;0,2;nd;1,3;1,0;2,1;0,4;3,9;0,7;-0,4;0,5
1972-T1;1,1;8,2;1,6;nd;1,7;0,8;5,0;-0,8;3,9;1,4;0,3;-0,6
1971-T4;1,0;-0,4;1,1;nd;0,9;1,7;0,2;-0,6;0,1;1,0;-0,2;0,1
1971-T3;1,3;5,4;1,5;nd;1,4;3,1;-1,4;1,0;4,3;1,4;0,1;-0,1
1971-T2;1,1;2,6;1,6;nd;1,8;3,0;-0,7;2,3;1,3;1,5;-0,2;-0,2
1971-T1;1,6;-1,3;0,8;nd;3,0;2,1;8,5;-2,1;2,3;1,5;-0,6;0,6
1970-T4;1,3;1,2;2,5;nd;0,2;2,0;-3,3;1,3;2,6;1,7;-0,6;0,2
1970-T3;1,1;4,1;0,6;nd;1,4;0,7;3,1;0,8;1,9;1,0;0,4;-0,3
1970-T2;1,8;3,7;1,2;nd;2,3;1,7;3,6;1,8;4,0;1,5;0,2;0,1
1970-T1;1,5;1,8;2,0;nd;-0,1;1,1;-3,6;1,4;4,6;1,3;-0,2;0,4
1969-T4;1,5;-1,1;-0,8;nd;1,6;-1,2;8,0;-0,2;4,9;0,2;0,4;0,9
1969-T3;1,4;-1,1;1,0;nd;1,4;0,3;3,3;1,7;3,1;1,2;-0,4;0,6
1969-T2;2,1;6,3;2,8;nd;3,7;5,3;1,6;2,1;3,3;2,8;-0,2;-0,5
1969-T1;0,9;4,4;-0,4;nd;-0,4;-0,1;-0,5;0,0;3,6;-0,1;1,1;-0,1
1968-T4;1,1;5,4;2,6;nd;1,7;3,2;-0,5;0,8;-2,6;2,1;0,2;-1,2
1968-T3;8,0;20,1;5,0;nd;9,1;14,3;4,1;2,2;26,5;5,7;1,6;0,8
1968-T2;-5,3;-8,4;-0,5;nd;-5,6;-8,0;0,0;-6,2;-14,1;-1,6;-2,8;-0,9
1968-T1;2,7;5,2;0,1;nd;2,7;2,7;4,4;0,1;6,1;0,9;1,7;0,1
1967-T4;1,0;1,8;0,7;nd;1,7;2,8;0,7;0,0;3,9;1,0;-0,2;0,3
1967-T3;1,1;2,1;1,2;nd;1,3;0,7;3,0;0,5;0,9;1,2;0,1;-0,2
1967-T2;1,2;-1,9;0,8;nd;1,6;1,4;3,2;0,4;2,6;1,0;-0,5;0,6
1967-T1;1,7;4,3;1,5;nd;3,0;2,4;3,2;4,2;3,2;1,9;-0,1;-0,1
1966-T4;0,6;3,4;1,7;nd;0,9;0,9;-0,6;2,8;-1,2;1,4;-0,1;-0,6
1966-T3;1,2;4,2;0,5;nd;1,8;3,0;-0,4;1,7;2,5;0,9;0,4;-0,2
1966-T2;1,6;2,3;1,9;nd;2,1;1,9;3,2;1,3;1,6;1,8;-0,1;-0,1
1966-T1;0,9;3,1;0,9;nd;1,5;2,9;0,9;-1,0;0,4;1,1;0,1;-0,3
1965-T4;1,5;2,2;0,3;nd;3,3;1,8;9,0;0,1;3,0;1,1;0,3;0,1
1965-T3;1,5;1,5;1,7;nd;0,3;0,0;0,3;1,1;2,9;1,2;0,1;0,2
1965-T2;1,8;2,7;2,5;nd;2,3;2,0;2,5;2,6;2,4;2,1;-0,3;0,0
1965-T1;0,5;-1,5;-0,3;nd;0,3;-0,7;0,9;1,8;2,9;0,1;-0,2;0,6
1964-T4;1,4;0,5;1,2;nd;1,4;-0,9;4,6;3,6;4,4;1,2;-0,3;0,5
1964-T3;0,8;-0,3;0,8;nd;2,7;2,0;4,2;2,4;0,7;1,3;-0,7;0,1
1964-T2;1,3;2,1;0,2;nd;1,2;0,8;1,9;1,8;-0,5;0,6;1,0;-0,3
1964-T1;2,2;5,9;2,0;nd;3,3;2,0;5,4;4,5;4,4;2,2;0,2;-0,2
1963-T4;-0,2;4,7;1,3;nd;0,0;2,1;-6,1;1,5;-0,4;0,9;-0,5;-0,7
1963-T3;3,4;2,4;2,0;nd;5,3;3,5;11,4;3,2;3,8;2,7;0,5;0,2
1963-T2;4,5;10,9;2,9;nd;6,0;4,2;3,8;14,2;4,8;3,4;1,7;-0,7
1963-T1;-1,0;0,1;1,7;nd;-0,1;0,5;3,8;-6,3;1,5;1,0;-2,2;0,2
1962-T4;1,1;1,4;0,9;nd;-0,2;-1,1;-0,1;2,3;1,9;0,7;0,4;0,1
1962-T3;1,9;4,1;1,7;nd;2,2;3,1;-0,1;2,5;-0,4;1,7;0,8;-0,5
1962-T2;1,5;-4,1;1,6;nd;1,0;0,7;0,0;2,9;-0,3;1,4;-0,3;0,5
1962-T1;2,2;4,2;3,2;nd;2,0;2,4;0,2;3,3;1,0;2,6;0,0;-0,4
1961-T4;1,8;3,0;1,2;nd;1,5;1,2;1,0;3,4;-0,7;1,4;0,9;-0,5
1961-T3;0,9;0,4;0,9;nd;2,7;2,9;1,8;3,3;0,4;1,4;-0,5;0,0
1961-T2;0,6;4,4;0,9;nd;0,6;-1,1;2,8;3,2;2,4;0,9;-0,1;-0,2
1961-T1;1,4;0,2;2,5;nd;5,3;6,9;3,6;2,8;1,4;2,8;-1,6;0,2
1960-T4;1,1;0,5;1,6;nd;2,3;2,0;3,1;2,3;0,1;1,6;-0,5;0,0
1960-T3;1,7;6,0;1,0;nd;2,7;3,1;2,4;1,7;3,3;1,3;0,6;-0,2
1960-T2;2,5;-1,0;1,4;nd;2,7;3,8;1,5;1,1;0,8;1,5;0,8;0,2
1960-T1;2,0;3,5;2,0;nd;-0,5;-1,5;0,6;0,8;6,8;1,0;0,4;0,6
1959-T4;2,5;7,6;0,8;nd;2,8;4,4;0,3;1,3;5,3;1,2;1,5;-0,2
1959-T3;1,1;0,7;0,7;nd;0,9;0,9;0,0;2,2;4,3;0,7;-0,1;0,5
1959-T2;1,2;4,4;-0,3;nd;2,6;3,8;-0,2;3,2;7,9;0,5;0,2;0,5
1959-T1;0,2;-3,0;0,9;nd;0,3;-0,6;-0,3;4,0;-1,6;0,7;-0,6;0,1
1958-T4;0,3;-2,0;1,7;nd;1,6;1,7;0,0;3,4;4,9;1,4;-1,9;0,9
1958-T3;-0,2;-2,0;-0,5;nd;0,3;-0,6;0,4;2,2;1,7;-0,2;-0,5;0,5
1958-T2;0,4;0,7;0,1;nd;-1,0;-2,6;1,0;0,9;-1,7;-0,2;0,9;-0,3
1958-T1;1,3;0,4;-1,1;nd;3,6;5,8;1,7;-0,6;1,0;0,1;1,1;0,1
1957-T4;0,3;-4,0;0,4;nd;1,1;0,8;2,2;0,0;-0,5;0,4;-0,6;0,5
1957-T3;1,7;-1,4;1,0;nd;1,9;1,8;2,7;1,0;-0,1;1,0;0,4;0,2
1957-T2;0,7;0,9;1,4;nd;-0,9;-3,6;2,9;2,0;1,5;0,7;-0,1;0,1
1957-T1;1,9;4,0;0,7;nd;4,6;6,0;2,6;3,6;5,7;1,5;0,2;0,2
1956-T4;1,5;2,4;1,4;nd;3,4;4,2;1,8;3,3;-0,3;1,7;0,1;-0,4
1956-T3;1,2;4,5;1,8;nd;1,0;0,5;0,6;3,2;1,8;1,5;0,1;-0,4
1956-T2;1,7;9,8;1,6;nd;5,7;9,9;-0,4;3,0;5,1;2,5;-0,2;-0,6
1956-T1;0,8;1,5;2,0;nd;-1,6;-3,3;-0,8;2,5;-6,1;1,2;0,5;-1,0
1955-T4;1,1;4,2;1,6;nd;1,8;2,6;-0,2;2,6;-0,6;1,6;0,1;-0,6
1955-T3;1,5;3,0;1,3;nd;2,5;3,3;1,0;2,5;1,6;1,5;0,1;-0,1
1955-T2;1,4;3,6;2,3;nd;3,8;5,1;2,6;2,3;-0,4;2,3;-0,4;-0,5
1955-T1;1,3;-0,2;1,7;nd;1,0;-1,1;4,1;2,4;0,5;1,3;0,0;0,1
1954-T4;0,7;0,7;0,2;nd;2,0;0,4;5,1;2,6;1,0;0,6;0,1;0,1
1954-T3;1,6;0,5;0,9;nd;4,1;3,8;5,7;3,2;4,1;1,4;-0,3;0,5
1954-T2;1,7;1,4;0,9;nd;4,8;4,9;5,7;3,6;2,6;1,5;0,1;0,2
1954-T1;1,4;3,0;1,2;nd;-0,9;-4,6;5,2;3,6;2,0;0,4;1,1;-0,1
1953-T4;1,6;-1,0;1,1;nd;2,6;1,9;4,1;3,2;5,1;1,2;-0,4;0,8
1953-T3;0,4;0,8;0,5;nd;1,9;1,3;2,8;2,5;-2,9;0,7;0,2;-0,5
1953-T2;1,6;-0,6;1,7;nd;2,1;2,4;1,5;1,6;0,2;1,5;0,0;0,1
1953-T1;1,2;2,6;1,6;nd;3,0;4,5;0,6;1,2;-1,5;1,7;0,2;-0,6
1952-T4;-0,2;-2,2;1,1;nd;-1,5;-3,5;0,7;2,1;-0,3;0,6;-1,1;0,3
1952-T3;1,0;1,0;1,0;nd;0,5;-0,6;1,2;3,6;1,0;0,9;0,1;0,0
1952-T2;-0,5;-4,1;0,6;nd;-2,5;-6,2;2,1;5,4;-0,1;0,1;-1,3;0,6
1952-T1;1,5;-0,7;1,5;nd;0,7;-1,6;3,4;6,9;-1,1;1,4;0,2;-0,1
1951-T4;1,0;3,7;1,0;nd;2,0;0,5;4,9;5,3;-4,4;1,3;1,0;-1,3
1951-T3;1,4;6,2;1,4;nd;1,4;-0,3;6,5;3,0;1,6;1,4;0,7;-0,6
1951-T2;0,8;5,9;0,6;nd;0,1;-1,9;7,7;0,1;-0,6;0,6;1,1;-0,9
1951-T1;0,3;3,2;1,8;nd;5,8;6,9;8,7;-2,3;0,1;2,3;-1,6;-0,4
1950-T4;2,4;6,4;1,3;nd;0,7;-0,4;7,5;-1,7;13,0;1,2;0,0;1,2
1950-T3;2,5;3,5;4,2;nd;2,5;2,5;5,6;-0,6;4,8;3,2;-1,0;0,3
1950-T2;2,5;-2,0;2,2;nd;1,7;1,5;3,3;1,0;3,6;1,9;-0,2;0,8
1950-T1;2,8;9,7;1,6;nd;0,3;-0,6;1,1;3,3;8,1;nd;nd;nd
1949-T4;1,3;-5,6;-0,4;nd;1,1;0,8;0,8;1,9;2,5;nd;nd;nd
1949-T3;1,5;-4,6;2,3;nd;1,3;1,1;1,0;1,9;0,8;nd;nd;nd
1949-T2;0,9;0,0;0,9;nd;1,5;1,3;1,7;1,8;3,1;nd;nd;nd""".replace(
            "nd", "NaN"
        )
        .replace("-T", "-Q")
        .replace(",", ".")
    )
    df = pd.read_csv(data, sep=";")
    df = df.set_index("quarter").astype(float)
    df["date"] = pd.PeriodIndex(df.index, freq="Q").to_timestamp()

    # return get_unemployement()
    return df.sort_values("date")


@DataParser.register_dataset(
    label="gmacro.fr_unemployement",
    summary="Évolution du produit intérieur brut et de ses composantes",
    category="Economics",
    enrich_data="https://github.com/gtherin/bulkhours/blob/main/bulkhours/data/gmacro.py",
    ref_source="https://www.insee.fr/fr/statistiques/2830547#tableau-figure1",
)
def get_fr_unemployement(self):
    data = StringIO(
        """quarter,1975-T1,1975-T2,1975-T3,1975-T4,1976-T1,1976-T2,1976-T3,1976-T4,1977-T1,1977-T2,1977-T3,1977-T4,1978-T1,1978-T2,1978-T3,1978-T4,1979-T1,1979-T2,1979-T3,1979-T4,1980-T1,1980-T2,1980-T3,1980-T4,1981-T1,1981-T2,1981-T3,1981-T4,1982-T1,1982-T2,1982-T3,1982-T4,1983-T1,1983-T2,1983-T3,1983-T4,1984-T1,1984-T2,1984-T3,1984-T4,1985-T1,1985-T2,1985-T3,1985-T4,1986-T1,1986-T2,1986-T3,1986-T4,1987-T1,1987-T2,1987-T3,1987-T4,1988-T1,1988-T2,1988-T3,1988-T4,1989-T1,1989-T2,1989-T3,1989-T4,1990-T1,1990-T2,1990-T3,1990-T4,1991-T1,1991-T2,1991-T3,1991-T4,1992-T1,1992-T2,1992-T3,1992-T4,1993-T1,1993-T2,1993-T3,1993-T4,1994-T1,1994-T2,1994-T3,1994-T4,1995-T1,1995-T2,1995-T3,1995-T4,1996-T1,1996-T2,1996-T3,1996-T4,1997-T1,1997-T2,1997-T3,1997-T4,1998-T1,1998-T2,1998-T3,1998-T4,1999-T1,1999-T2,1999-T3,1999-T4,2000-T1,2000-T2,2000-T3,2000-T4,2001-T1,2001-T2,2001-T3,2001-T4,2002-T1,2002-T2,2002-T3,2002-T4,2003-T1,2003-T2,2003-T3,2003-T4,2004-T1,2004-T2,2004-T3,2004-T4,2005-T1,2005-T2,2005-T3,2005-T4,2006-T1,2006-T2,2006-T3,2006-T4,2007-T1,2007-T2,2007-T3,2007-T4,2008-T1,2008-T2,2008-T3,2008-T4,2009-T1,2009-T2,2009-T3,2009-T4,2010-T1,2010-T2,2010-T3,2010-T4,2011-T1,2011-T2,2011-T3,2011-T4,2012-T1,2012-T2,2012-T3,2012-T4,2013-T1,2013-T2,2013-T3,2013-T4,2014-T1,2014-T2,2014-T3,2014-T4,2015-T1,2015-T2,2015-T3,2015-T4,2016-T1,2016-T2,2016-T3,2016-T4,2017-T1,2017-T2,2017-T3,2017-T4,2018-T1,2018-T2,2018-T3,2018-T4,2019-T1,2019-T2,2019-T3,2019-T4,2020-T1,2020-T2,2020-T3,2020-T4,2021-T1,2021-T2,2021-T3,2021-T4,2022-T1,2022-T2,2022-T3
Femmes,"4,6","4,9","5,2","5,5","5,8","5,9","5,8","5,8","6,1","6,5","6,6","6,5","6,3","6,3","6,6","7,0","7,1","7,2","7,4","7,7","8,0","8,1","8,2","8,4","8,8","9,1","9,3","9,4","9,4","9,5","9,6","9,7","9,6","9,5","9,7","10,0","10,5","10,8","10,9","11,1","11,2","11,1","11,1","10,9","10,8","10,9","11,1","11,2","11,4","11,5","11,3","11,3","11,2","11,0","11,1","11,0","10,8","10,6","10,4","10,3","10,3","10,2","10,1","10,0","10,0","10,1","10,3","10,6","10,8","10,9","11,0","11,1","11,2","11,3","11,6","11,8","12,0","12,1","12,1","11,9","11,8","11,5","11,3","11,4","11,7","11,9","11,9","11,8","11,8","11,8","11,8","11,8","11,6","11,5","11,4","11,4","11,4","11,3","11,1","10,7","10,3","9,9","9,6","9,4","9,2","9,1","8,9","8,8","8,7","8,6","8,7","8,7","9,3","9,4","9,1","9,5","10,0","9,5","9,6","9,5","9,2","9,5","9,9","10,0","10,0","9,6","9,8","8,6","9,0","8,6","8,2","7,8","7,5","7,7","7,8","8,2","8,8","9,3","9,4","9,4","9,4","9,4","9,4","9,8","9,7","9,4","9,5","9,4","9,4","9,8","9,7","10,1","10,2","10,3","10,1","10,1","9,8","9,9","10,1","10,1","9,9","10,0","9,9","9,8","9,7","9,8","10,0","9,9","9,7","9,5","9,4","8,9","9,3","9,1","8,9","8,8","8,7","8,4","8,3","8,1","8,0","6,8","9,0","8,0","7,8","7,9","8,1","7,3","7,3","7,3","7,1"
Femmes_15-24,"9,8","10,4","11,1","11,8","12,8","13,1","12,7","12,6","13,5","14,6","15,0","14,7","14,4","14,5","15,7","16,6","16,9","17,3","17,8","18,7","19,7","20,2","20,4","20,9","21,8","22,6","23,2","23,5","23,5","23,8","24,1","24,1","23,8","23,9","24,5","25,6","27,2","28,2","28,5","28,7","28,4","27,5","27,2","26,6","26,1","26,1","26,2","26,0","25,8","25,5","25,0","24,7","24,5","24,1","23,9","23,1","22,5","22,1","21,5","21,6","21,6","21,4","21,2","21,5","21,8","22,4","23,0","23,2","23,8","23,9","24,4","25,0","25,6","26,3","27,0","27,5","28,2","28,9","29,1","29,0","28,7","27,7","26,8","27,1","27,5","28,1","28,7","29,0","29,1","28,8","28,3","27,7","26,6","26,2","26,2","26,3","26,7","26,4","25,4","23,9","22,4","21,3","20,5","20,1","20,0","19,8","19,6","19,9","20,0","19,7","19,4","20,1","22,8","23,3","21,4","23,3","24,4","24,6","24,9","24,8","24,1","24,6","27,2","26,9","27,6","27,4","28,9","25,0","26,4","24,0","22,0","22,7","21,4","21,9","22,1","23,8","25,9","26,6","26,9","26,4","25,9","28,7","28,4","28,1","29,2","27,2","26,5","26,4","26,2","26,5","28,0","30,7","30,0","30,3","29,2","28,5","27,7","26,5","27,1","27,2","27,1","28,2","27,5","26,8","27,3","28,4","29,3","26,9","25,2","26,6","24,2","23,8","25,4","23,0","22,6","22,9","21,5","20,9","21,0","23,0","22,8","24,1","26,0","21,5","21,3","19,6","19,7","15,0","15,8","17,5","16,5"
Femmes_25-49,"3,3","3,5","3,7","3,9","4,0","4,0","4,0","4,0","4,1","4,3","4,4","4,4","4,3","4,2","4,4","4,5","4,5","4,6","4,7","4,8","4,9","5,0","5,0","5,2","5,5","5,8","5,9","6,0","6,0","6,1","6,2","6,2","6,2","6,1","6,2","6,4","6,7","6,9","7,0","7,2","7,4","7,6","7,7","7,7","7,7","7,9","8,2","8,4","8,7","8,9","8,8","8,9","8,9","8,8","9,1","9,1","9,1","8,9","8,8","8,7","8,6","8,6","8,5","8,5","8,4","8,4","8,7","9,0","9,2","9,4","9,5","9,5","9,6","9,8","10,0","10,3","10,6","10,7","10,7","10,5","10,3","10,2","10,1","10,2","10,5","10,6","10,6","10,5","10,5","10,6","10,7","10,7","10,6","10,5","10,5","10,5","10,5","10,4","10,2","9,9","9,6","9,3","9,1","8,8","8,7","8,5","8,4","8,2","8,0","8,0","8,1","8,1","8,6","8,6","8,4","8,6","8,9","8,6","8,7","8,6","8,4","8,7","8,7","9,0","8,9","8,2","8,5","7,6","7,7","7,6","7,6","6,9","6,6","6,8","6,9","7,3","7,7","8,1","8,3","8,3","8,3","8,0","8,1","8,6","8,4","8,3","8,6","8,4","8,7","8,9","8,8","8,8","9,0","9,2","8,9","9,0","8,6","9,1","9,2","9,3","9,1","9,0","9,0","8,9","8,9","8,7","8,7","9,1","8,9","8,6","9,0","8,1","8,7","8,5","8,2","7,9","7,8","7,6","7,5","7,1","7,1","5,9","8,0","7,1","7,3","7,2","7,4","6,9","6,7","6,6","6,4"
Femmes_plus_50,"2,1","2,2","2,4","2,5","2,6","2,7","2,8","3,0","3,2","3,3","3,3","3,1","2,9","2,9","3,1","3,3","3,5","3,7","3,9","4,2","4,5","4,6","4,6","4,6","4,7","4,7","4,8","4,8","4,8","4,9","5,1","5,1","5,1","5,1","5,1","5,2","5,4","5,5","5,5","5,6","5,7","5,7","5,9","5,8","5,6","5,6","5,6","5,8","6,2","6,4","6,6","6,7","6,6","6,5","6,4","6,4","6,4","6,3","6,2","6,1","6,1","6,0","6,1","6,1","6,3","6,4","6,6","6,8","6,9","6,9","6,8","6,6","6,3","6,2","6,2","6,3","6,2","6,0","6,0","6,0","6,1","6,1","6,0","6,0","6,4","6,5","6,7","6,8","6,9","6,9","6,9","6,9","7,0","7,0","7,0","7,0","6,9","6,9","6,8","6,6","6,4","6,2","6,0","5,7","5,5","5,5","5,5","5,2","5,2","5,4","5,4","5,2","4,8","5,5","5,5","5,9","6,6","5,3","5,3","5,6","5,4","5,0","5,6","5,4","5,3","5,8","5,4","4,8","5,3","4,9","4,5","4,3","4,0","4,4","4,5","4,4","4,8","5,5","5,1","5,9","5,8","5,5","5,6","5,8","5,8","5,5","5,7","5,9","5,4","6,3","5,8","6,1","6,4","6,5","6,6","6,6","6,9","6,6","6,9","6,5","6,2","6,6","6,4","6,5","6,3","6,2","6,8","6,4","6,8","6,3","6,1","6,0","6,0","6,3","6,1","6,5","6,7","6,2","6,1","5,6","5,4","4,0","6,3","5,7","4,8","5,8","5,7","5,5","5,6","5,1","5,3"
Hommes,"2,3","2,6","2,8","2,9","2,9","2,8","2,7","2,7","2,9","3,1","3,3","3,3","3,2","3,3","3,5","3,7","3,8","3,8","3,8","3,8","3,7","3,7","3,7","4,0","4,4","4,7","4,9","5,1","5,2","5,3","5,5","5,6","5,6","5,7","5,8","6,1","6,5","6,9","7,2","7,5","7,6","7,6","7,7","7,7","7,7","7,7","7,7","7,6","7,6","7,6","7,5","7,4","7,4","7,2","7,1","6,8","6,6","6,4","6,3","6,3","6,3","6,3","6,3","6,3","6,3","6,4","6,6","6,8","7,1","7,3","7,6","7,9","8,2","8,6","9,0","9,4","9,6","9,6","9,4","9,1","8,8","8,6","8,5","8,7","9,0","9,3","9,4","9,6","9,7","9,7","9,6","9,5","9,2","9,1","9,0","9,1","9,2","9,1","8,8","8,4","8,0","7,6","7,2","6,9","6,6","6,5","6,7","6,9","7,1","7,2","7,2","7,3","7,6","7,7","7,8","8,1","8,1","8,1","8,2","8,3","8,2","8,2","8,2","8,2","8,4","8,4","8,1","8,1","8,0","7,7","7,7","7,1","6,9","6,9","7,1","7,3","8,4","9,1","9,0","9,6","9,4","9,2","9,1","8,7","8,7","8,8","9,0","9,3","9,6","9,6","9,8","10,2","10,5","10,6","10,4","10,2","10,5","10,4","10,5","10,8","10,7","11,0","10,8","10,7","10,7","10,3","9,8","10,2","9,6","9,6","9,6","9,1","9,2","9,1","9,1","8,7","8,8","8,5","8,5","8,3","7,8","7,4","9,0","8,2","8,5","8,0","7,9","7,5","7,4","7,6","7,6"
Hommes_15-24,"4,8","5,4","5,8","6,0","6,0","5,8","5,6","5,9","6,6","7,2","7,5","7,2","6,8","6,9","7,5","7,9","8,0","8,0","8,0","8,0","8,2","8,2","8,3","9,0","9,8","10,5","11,1","11,5","11,7","12,0","12,5","12,8","12,9","13,1","13,7","14,6","15,8","17,0","17,8","18,2","18,5","18,0","17,7","17,3","16,9","16,9","16,3","15,8","15,5","15,3","15,1","15,2","15,1","14,6","14,0","13,2","12,5","12,2","12,2","12,5","12,9","13,0","13,0","13,1","12,9","13,2","13,3","13,4","13,7","14,1","15,1","16,0","16,8","17,8","18,6","19,1","19,7","20,1","19,3","18,3","17,4","16,6","16,1","17,0","17,6","18,6","19,1","19,6","19,9","19,8","19,4","18,9","18,4","18,3","18,9","19,5","20,2","19,9","18,9","17,5","16,2","15,4","14,8","14,4","14,2","14,2","14,8","15,3","15,6","15,9","16,6","16,9","16,0","17,7","18,4","19,3","19,2","18,9","19,6","19,4","19,5","18,9","19,9","19,6","21,1","20,7","19,1","21,0","19,1","18,8","18,2","17,7","16,7","17,8","19,1","20,2","22,6","24,1","24,2","24,4","23,5","21,7","23,1","20,4","21,1","21,6","21,0","22,0","22,6","23,7","24,4","25,6","25,1","24,1","23,6","22,5","23,3","24,6","24,4","25,3","25,6","24,3","24,8","25,3","25,3","24,0","23,8","23,7","22,7","23,1","22,2","21,2","21,0","21,3","22,1","19,0","20,7","20,1","19,0","20,4","18,8","20,9","20,3","19,1","20,7","19,4","18,8","17,0","17,3","18,5","19,8"
Hommes_25-49,"1,7","1,9","2,1","2,1","2,1","2,0","1,9","1,9","2,0","2,1","2,3","2,3","2,3","2,4","2,5","2,6","2,8","2,8","2,8","2,7","2,6","2,6","2,6","2,9","3,1","3,4","3,6","3,8","3,8","3,9","4,0","4,0","4,0","4,0","4,2","4,4","4,7","5,0","5,2","5,4","5,6","5,6","5,8","5,9","5,9","6,0","6,1","6,1","6,2","6,2","6,1","6,1","6,1","6,0","6,0","5,8","5,6","5,5","5,5","5,4","5,4","5,4","5,4","5,4","5,5","5,6","5,8","6,0","6,2","6,4","6,7","7,0","7,4","7,8","8,2","8,5","8,7","8,7","8,6","8,4","8,2","8,0","8,0","8,1","8,3","8,5","8,6","8,8","8,9","9,0","9,0","8,8","8,5","8,3","8,2","8,2","8,2","8,2","7,9","7,6","7,3","6,9","6,6","6,3","6,0","6,0","6,1","6,3","6,5","6,6","6,4","6,4","7,0","7,0","6,9","7,3","7,3","7,2","7,3","7,7","7,5","7,6","7,4","7,3","7,4","7,5","7,3","6,9","7,2","7,0","7,0","6,4","6,2","5,9","6,1","6,2","7,3","8,0","7,8","8,5","8,4","8,4","8,1","8,0","7,9","8,0","8,3","8,7","8,9","8,9","9,0","9,2","9,6","9,9","9,8","9,7","10,0","9,7","9,9","10,0","9,9","10,2","9,9","9,8","9,9","9,5","8,6","9,2","8,7","8,7","8,6","8,2","8,3","8,2","8,1","8,1","7,8","7,6","7,7","7,4","7,0","6,7","8,7","7,6","7,6","6,9","6,9","6,7","6,5","6,7","6,5"
Hommes_plus_50,"1,8","2,0","2,1","2,2","2,2","2,2","2,2","2,2","2,3","2,5","2,5","2,6","2,7","2,7","2,8","2,9","2,9","3,0","3,0","3,0","3,0","3,0","3,1","3,2","3,4","3,5","3,6","3,7","3,8","3,8","3,9","3,9","3,9","4,0","4,0","4,0","4,1","4,3","4,4","4,5","4,6","4,8","5,1","5,3","5,3","5,4","5,3","5,3","5,4","5,4","5,4","5,4","5,4","5,2","5,1","5,0","5,0","4,8","4,6","4,5","4,4","4,3","4,3","4,4","4,4","4,5","4,8","5,0","5,3","5,5","5,5","5,4","5,3","5,4","5,6","5,8","5,9","5,8","5,8","5,7","5,8","5,8","5,8","5,8","6,1","6,3","6,3","6,3","6,4","6,4","6,4","6,5","6,5","6,6","6,7","6,7","6,7","6,6","6,4","6,1","5,8","5,5","5,1","4,7","4,4","4,3","4,4","4,5","4,6","4,8","4,9","4,9","4,9","4,7","5,2","5,1","5,0","5,5","4,9","4,7","4,6","4,6","4,9","5,4","5,3","5,2","5,0","5,2","5,2","4,6","4,7","4,2","4,3","4,9","4,4","4,3","4,8","5,1","5,5","5,8","5,7","5,5","5,5","5,4","5,2","5,5","5,8","5,8","6,1","5,9","6,1","6,8","6,9","7,0","7,0","6,6","6,9","6,9","6,6","7,5","7,0","7,9","7,6","7,4","7,2","7,2","7,4","7,4","6,9","6,8","7,1","6,8","6,8","6,5","6,3","6,1","6,6","6,3","6,4","6,0","5,5","4,7","5,9","5,7","6,0","6,1","6,0","5,9","5,5","5,2","5,0"
Ensemble,"3,2","3,5","3,8","3,9","4,0","4,0","3,9","4,0","4,2","4,5","4,7","4,6","4,5","4,5","4,8","5,0","5,1","5,2","5,3","5,4","5,5","5,5","5,6","5,8","6,2","6,5","6,8","6,9","7,0","7,1","7,2","7,3","7,3","7,3","7,5","7,8","8,2","8,6","8,8","9,0","9,1","9,1","9,1","9,1","9,0","9,1","9,1","9,2","9,3","9,3","9,2","9,1","9,0","8,9","8,9","8,7","8,4","8,3","8,1","8,1","8,1","8,0","8,0","8,0","7,9","8,1","8,3","8,5","8,7","8,9","9,1","9,3","9,6","9,9","10,2","10,5","10,7","10,7","10,6","10,4","10,2","9,9","9,8","9,9","10,2","10,5","10,5","10,6","10,7","10,7","10,6","10,5","10,3","10,2","10,1","10,2","10,2","10,2","9,9","9,5","9,1","8,7","8,4","8,0","7,8","7,7","7,7","7,8","7,8","7,9","7,9","7,9","8,4","8,5","8,4","8,8","9,0","8,8","8,9","8,9","8,6","8,8","9,0","9,1","9,2","9,0","8,9","8,4","8,5","8,1","8,0","7,5","7,2","7,3","7,4","7,7","8,6","9,2","9,2","9,5","9,4","9,3","9,2","9,2","9,2","9,1","9,2","9,3","9,5","9,7","9,7","10,2","10,3","10,5","10,3","10,1","10,1","10,2","10,3","10,5","10,3","10,5","10,3","10,2","10,2","10,0","9,9","10,0","9,6","9,5","9,5","9,0","9,3","9,1","9,0","8,7","8,7","8,4","8,4","8,2","7,9","7,1","9,0","8,1","8,2","7,9","8,0","7,4","7,3","7,4","7,3"
Ensemble_15-24,"7,0","7,6","8,2","8,6","9,1","9,1","8,9","8,9","9,7","10,6","11,0","10,6","10,2","10,4","11,2","11,9","12,1","12,3","12,5","12,9","13,5","13,6","13,8","14,4","15,3","16,1","16,7","17,0","17,0","17,4","17,8","17,9","17,8","18,0","18,5","19,6","21,0","22,1","22,6","23,0","23,0","22,3","22,0","21,5","21,1","21,1","20,9","20,5","20,2","20,0","19,7","19,6","19,4","19,0","18,5","17,7","17,0","16,7","16,4","16,7","16,9","16,8","16,7","16,9","17,0","17,4","17,7","17,8","18,3","18,5","19,3","20,1","20,8","21,7","22,5","23,0","23,6","24,0","23,7","23,2","22,6","21,7","21,0","21,6","22,1","22,9","23,4","23,8","24,0","23,8","23,4","22,9","22,1","21,9","22,1","22,5","23,0","22,8","21,7","20,4","19,0","18,0","17,4","16,9","16,8","16,7","17,0","17,3","17,5","17,6","17,8","18,3","19,1","20,3","19,8","21,1","21,6","21,5","22,0","21,8","21,5","21,5","23,2","22,9","24,1","23,7","23,5","22,8","22,5","21,2","19,9","19,9","18,8","19,7","20,4","21,8","24,1","25,2","25,5","25,3","24,6","24,9","25,5","23,8","24,8","24,2","23,5","24,0","24,2","25,0","26,0","27,9","27,3","26,9","26,1","25,3","25,3","25,5","25,6","26,2","26,3","26,1","26,1","26,0","26,2","26,0","26,4","25,2","23,9","24,7","23,0","22,4","23,0","22,1","22,3","20,7","21,1","20,5","19,9","21,6","20,6","22,4","22,9","20,2","21,0","19,5","19,2","16,1","16,6","18,0","18,3"
Ensemble_25-49,"2,3","2,5","2,7","2,8","2,8","2,8","2,7","2,7","2,8","3,0","3,1","3,2","3,1","3,1","3,2","3,4","3,5","3,5","3,6","3,6","3,6","3,5","3,6","3,8","4,1","4,4","4,6","4,7","4,8","4,8","4,9","4,9","4,9","4,9","5,0","5,3","5,6","5,8","6,0","6,2","6,4","6,5","6,6","6,7","6,7","6,8","7,0","7,1","7,3","7,4","7,3","7,3","7,3","7,2","7,3","7,3","7,1","7,0","6,9","6,9","6,9","6,8","6,8","6,8","6,8","6,9","7,1","7,3","7,6","7,8","7,9","8,1","8,4","8,7","9,0","9,4","9,6","9,6","9,6","9,4","9,2","9,0","8,9","9,1","9,3","9,5","9,5","9,6","9,7","9,7","9,8","9,7","9,5","9,3","9,2","9,2","9,3","9,2","9,0","8,7","8,4","8,0","7,8","7,5","7,3","7,2","7,2","7,2","7,2","7,2","7,2","7,2","7,8","7,8","7,6","7,9","8,1","7,9","8,0","8,1","7,9","8,1","8,0","8,1","8,1","7,8","7,9","7,3","7,4","7,3","7,3","6,6","6,4","6,4","6,5","6,7","7,5","8,0","8,0","8,4","8,3","8,2","8,1","8,3","8,2","8,1","8,4","8,6","8,8","8,9","8,9","9,0","9,3","9,5","9,4","9,4","9,3","9,4","9,6","9,7","9,5","9,6","9,5","9,3","9,4","9,1","8,7","9,2","8,8","8,6","8,8","8,1","8,5","8,4","8,2","8,0","7,8","7,6","7,6","7,3","7,1","6,3","8,3","7,4","7,4","7,0","7,1","6,8","6,6","6,6","6,5"
Ensemble_plus_50,"1,9","2,1","2,2","2,3","2,4","2,4","2,4","2,5","2,7","2,8","2,8","2,8","2,8","2,8","2,9","3,0","3,2","3,3","3,4","3,5","3,6","3,6","3,7","3,8","3,9","4,0","4,1","4,1","4,2","4,3","4,4","4,4","4,4","4,4","4,4","4,5","4,6","4,8","4,9","5,0","5,0","5,2","5,4","5,5","5,4","5,5","5,4","5,5","5,7","5,8","5,9","5,9","5,9","5,8","5,7","5,6","5,6","5,4","5,3","5,2","5,1","5,1","5,1","5,1","5,2","5,4","5,6","5,8","6,0","6,1","6,0","5,9","5,7","5,7","5,8","6,0","6,0","5,9","5,9","5,9","5,9","5,9","5,9","5,9","6,2","6,4","6,5","6,5","6,6","6,6","6,7","6,7","6,7","6,8","6,8","6,8","6,8","6,8","6,6","6,3","6,1","5,8","5,5","5,2","4,9","4,9","4,9","4,8","4,9","5,1","5,1","5,0","4,8","5,1","5,3","5,5","5,7","5,4","5,1","5,2","5,0","4,8","5,2","5,4","5,3","5,5","5,2","5,0","5,3","4,7","4,6","4,2","4,1","4,7","4,5","4,3","4,8","5,3","5,3","5,8","5,7","5,5","5,5","5,6","5,5","5,5","5,8","5,8","5,8","6,1","6,0","6,5","6,7","6,8","6,8","6,6","6,9","6,7","6,8","7,0","6,6","7,2","7,0","6,9","6,7","6,7","7,1","6,9","6,8","6,5","6,6","6,4","6,4","6,4","6,2","6,3","6,6","6,2","6,3","5,8","5,5","4,4","6,1","5,7","5,4","5,9","5,8","5,7","5,5","5,2","5,1"
Longue_duree,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,nd,"2,2","2,2","2,2","2,4","2,3","2,3","2,3","2,5","2,4","2,5","2,5","2,3","2,4","2,5","2,5","2,4","2,4","2,1","2,1","1,9","1,9","1,9","1,8","1,7","1,7","2,0","2,1","2,3","2,5","2,4","2,4","2,4","2,4","2,5","2,6","2,6","2,6","2,6","2,6","2,7","2,8","2,8","2,8","3,0","3,0","3,1","3,1","3,1","3,1","3,1","3,1","3,1","3,2","3,2","3,1","3,1","3,0","3,0","3,0","2,7","2,6","2,6","2,5","2,5","2,4","2,3","2,2","2,2","2,0","1,4","2,2","2,1","2,5","2,3","2,4","2,2","2,2","2,1","2,0"
""".replace(
            "nd", "NaN"
        ).replace(
            "-T", "-Q"
        )
    )

    df = pd.read_csv(data, sep=",", quotechar='"').set_index("quarter").T
    for c in df.columns:
        df[c] = df[c].astype(str).str.replace(",", ".").astype(float)
    df["date"] = pd.PeriodIndex(df.index, freq="Q").to_timestamp()
    return df.sort_values("date")


@DataParser.register_dataset(
    label="gmacro.us_gdp",
    summary="United States Macroeconomic data (1959q1 - 2009q3)",
    category="Economics",
    enrich_data="https://github.com/gtherin/bulkhours/blob/main/bulkhours/data/gmacro.py",
    ref_source="https://www.statsmodels.org/0.6.1/datasets/generated/macrodata.html",
    columns_description=r"""| Column   |      Info |
|-----------|:-----------|
| year      |  1959q1 - 2009q3 |
| quarter   |    1-4 |
| realgdp   | Real gross domestic product (Bil. of chained 2005\$, seasonally adjusted annual rate) |
| realcons  |  Real personal consumption expenditures (Bil. of chained 2005\$, seasonally adjusted annual rate)|
| realinv   |  Real gross private domestic investment (Bil. of chained 2005\$, seasonally adjusted annual rate)|
| realgovt  |  Real federal consumption expenditures & gross investment(Bil. of chained 2005 US\$, seasonally adjusted annual rate)|
| realdpi   |  Real private disposable income (Bil. of chained 2005 US\$, seasonally adjusted annual rate)|
| cpi       |  End of the quarter consumer price index for all urban consumers: all items (1982-84 = 100, seasonally adjusted).|
| m1        |  End of the quarter M1 nominal money stock (Seasonally adjusted)|
| tbilrate  |  Quarterly monthly average of the monthly 3-month treasury bill: secondary market rate|
| unemp     |  Seasonally adjusted unemployment rate (%)|
| pop       |  End of the quarter total population: all ages incl. armed forces over seas|
| infl      |  Inflation rate (ln(cpi_{t}/cpi_{t-1}) * 400)|
| realint   |  Real interest rate (tbilrate - infl)|
""",
)
def get_us_gdp(self, simplify=True):
    import statsmodels.api as sm  # Statistical models

    us_okun = sm.datasets.macrodata.load_pandas().data
    if not simplify:
        return us_okun

    us_okun["diff(gdp)"] = 100 * us_okun["realgdp"].diff() / us_okun["realgdp"]
    us_okun["diff(unemployement)"] = us_okun["unemp"].diff()
    us_okun["yquarter"] = us_okun["year"].astype(str).str[:4] + "-Q" + us_okun["quarter"].astype(str).str[0]
    us_okun = us_okun[["yquarter", "diff(gdp)", "diff(unemployement)"]]
    us_okun = us_okun.dropna()
    us_okun["quarter"] = pd.PeriodIndex(us_okun["yquarter"], freq="Q").to_timestamp()

    return us_okun.set_index("quarter")


@DataParser.register_dataset(
    label="gmacro.fr_gdp",
    summary="France Macroeconomic data",
    category="Economics",
    enrich_data="https://github.com/gtherin/bulkhours/blob/main/bulkhours/data/gmacro.py",
)
def get_fr_gdp(self, simplify=True):
    gdp = get_fr_qgdp(self).reset_index()
    une = get_fr_unemployement(self).reset_index()
    fr_okun = gdp.merge(une, how="inner", left_on="quarter", right_on="index")

    if not simplify:
        return fr_okun

    if simplify:
        fr_okun = fr_okun.rename(columns={"gdp": "diff(gdp)", "quarter": "yquarter"})
        fr_okun["diff(unemployement)"] = fr_okun["Ensemble"].diff()
        fr_okun = fr_okun[["yquarter", "diff(gdp)", "diff(unemployement)"]]
        fr_okun = fr_okun.dropna()
        fr_okun["quarter"] = pd.PeriodIndex(fr_okun["yquarter"], freq="Q").to_timestamp()

    return fr_okun.set_index("quarter")


@DataParser.register_dataset(
    label="world.happiness",
    summary="World happiness report data (2015-2020)",
    category="Economics",
    raw_data="https://happiness-report.s3.amazonaws.com/2023/DataForFigure2.1WHR2023.xls",
    ref_source="""https://worldhappiness.report/data/""",
)
def get_happiness(self, **data_info):
    df = self.read_raw_data(self.raw_data)

    return df.sort_values("Ladder score", ascending=False)[
        [
            "Country name",
            "Ladder score",
            "Logged GDP per capita",
            "Social support",
            "Healthy life expectancy",
            "Freedom to make life choices",
            "Generosity",
            "Perceptions of corruption",
        ]
    ].rename(columns={"Country name": "country"})


@DataParser.register_dataset(
    label="world.maphappiness",
    summary="World Bank Poverty and Inequality data (with gpx extra info)",
    reference="world.happiness",
)
def get_mappoverty(self, **kwargs):
    return get_mapgeneric(get_happiness(self, **kwargs))
